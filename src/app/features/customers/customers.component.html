<mat-card class="list-card">
  <div class="list-head">
    <div>
      <h2 class="list-title">Customers</h2>
      <p class="list-subtitle">Search, sort & manage customers</p>
    </div>

    <mat-form-field class="filter" appearance="outline">
      <mat-label>Filter</mat-label>
      <input
        matInput
        (input)="applyFilter(($any($event.target).value))"
        placeholder="Name, email, city, status…"
      />
      <mat-icon matIconSuffix>search</mat-icon>
    </mat-form-field>
  </div>

  <div class="table-wrap">
    <table mat-table [dataSource]="dataSource" matSort class="crm-table">

      <!-- Name (first + last) -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
        <td mat-cell *matCellDef="let u" class="cell-name">
          <span class="name__main">{{ u.firstName }} {{ u.lastName }}</span>
        </td>
      </ng-container>

      <!-- Email -->
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Email</th>
        <td mat-cell *matCellDef="let u" class="cell-email">
          {{ u.email || '—' }}
        </td>
      </ng-container>

      <!-- City -->
      <ng-container matColumnDef="city">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>City</th>
        <td mat-cell *matCellDef="let u">
          {{ u.city || '—' }}
        </td>
      </ng-container>

      <!-- Status (Chips) -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
        <td mat-cell *matCellDef="let u" class="cell-status">
          <mat-chip-set aria-label="Status">
            <mat-chip [class.chip--lead]="u.status === 'lead'"
                      [class.chip--customer]="u.status === 'customer'"
                      [class.chip--vip]="u.status === 'vip'">
              {{ statusLabel(u.status) }}
            </mat-chip>
          </mat-chip-set>
        </td>
      </ng-container>

      <!-- Actions -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="cell-actions"></th>
        <td mat-cell *matCellDef="let u" class="cell-actions" (click)="$event.stopPropagation()">
          <button mat-icon-button aria-label="Open" (click)="openUser(u)">
            <mat-icon>chevron_right</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>

      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns"
        class="crm-row"
        (click)="openUser(row)"
      ></tr>
    </table>

    <!-- Empty state -->
    <div class="empty" *ngIf="dataSource.data.length === 0">
      <div class="empty__title">No customers yet</div>
      <div class="empty__text">Click the + button to add your first customer.</div>
    </div>
  </div>

  <mat-paginator
    [pageSizeOptions]="[5, 10, 25]"
    [pageSize]="10"
    showFirstLastButtons
  ></mat-paginator>
</mat-card>

<!-- FAB -->
<button
  mat-fab
  color="primary"
  class="add-customer-btn"
  matTooltip="Add customer"
  matTooltipPosition="left"
  (click)="openAddCustomerDialog($event)"
>
  <mat-icon>add</mat-icon>
</button>
